# Qualification Round

## A. Арт-критика

- Ограничение времени: 2 секунды
- Ограничение памяти: 256 Mb
- Ввод: стандартный ввод или input.txt
- Вывод: стандартный вывод или output.txt

Аркадий — главный редактор журнала по арт-критике. По долгу службы Аркадий постоянно сталкивается с фундаментальными
вопросами "Что есть красота?”, “Как понять что красиво, а что нет?”.

Главред понимает, что искусство можно оценивать по-разному и к разным арт-объектам можно применять разные метрики. За
годы работы в арт-индустрии Аркадий выработал собственный принцип оценки красоты любого произведения искусства. Он может
сказать, красив арт-объект или нет, вне зависимости от количества критериев оценки "красивости".

Принцип Аркадия состоит в следующем:

Для произвольного объекта искусства определяется некоторое количество критериев в определенном порядке для оценки
“красивости”. По каждому критерию можно набрать максимум `n` первичных баллов. Вторичные баллы за условный критерий `i`
определяются следующим образом:

- Если при оценке критерия набирается <code>a<sub>i</sub></code> первичных баллов, то Аркадий начисляет критерию <code>
  a<sup>2</sup><sub>i</sub></code>
  вторичных баллов
- Кроме того, Аркадий прибавляет бонусные баллы <b>за <code>a<sub>i</sub></code> следующих ненулевых</b> оценок по
  другим критериям (прибавляются первичные баллы)
- Для последнего критерия дополнительные баллы не начисляются

Например, если `n = 10`, Аркадий оценивал картину по пяти критериям, и арт-объект набрал `[10, 0, 1, 0, 3]` первичных
баллов соответственно, то его итоговый результат будет равен 117 вторичных баллов, так как за первый критерий он получил
10<sup>2</sup> + 1 + 3 балла, за второе и четвертое — по 0, за третье — 1<sup>2</sup> + 3, за пятое — 3<sup>2</sup>.

Аркадий дал последовательность результатов `m` оценок критериев произведения искусства. Определите общую сумму вторичных
баллов.

### Формат ввода

В первой строке даны два целых числа `n` и `m` `(1 ≤ n, m ≤ 200000)`.
Во второй строке заданы `m` целых чисел <code>a<sub>i</sub> (0 ≤ a<sub>i</sub> ≤ n)</code>.

### Формат вывода

Выведите сумму набранных баллов.

#### Пример 1

**Ввод**

```
10 5
10 0 1 0 3
```

**Вывод**

```
117
```

#### Пример 2

**Ввод**

```
5 5
0 0 0 0 0
```

**Вывод**

```
0
```

#### Пример 3

**Ввод**

```
1 3
1 1 1
```

**Вывод**

```
5
```

## B. Хокку на английском

- Ограничение времени: 2 секунды
- Ограничение памяти: 256 Mb
- Ввод: стандартный ввод или input.txt
- Вывод: стандартный вывод или output.txt

Поэт пытается освоить жанр традиционной японской лирической поэзии — хокку. Он мечтает писать хокку на японском языке. К
его большому сожалению, изучение японского даётся ему слишком тяжело. Поэтому он тренируется писать хокку на английском.
Такой жанр поэзии требует математической гармонии в сложении звуков, слов и смыслов. Поэт уверен, что создать
по-настоящему совершенное хокку на английском языке он сможет только с помощью человека с техническим складом ума. Он
обращается к вам за помощью.

У поэта есть для вас правило, на основе которого вам нужно написать функцию. Он приготовил для вас строку `s`. Строка
состоит из строчных и заглавных букв английского алфавита.

Вам предстоит изменить в строке наименьшее количество символов так, чтобы:

- в `s` встречалась подстрока `Yandex` (регистр имеет значение).
- в `s` встречалась подстрока `Cup` (регистр имеет значение).
- хотя бы для одной пары подстрок `Yandex` и `Cup`, первым шло слово `Yandex`.

Ваша задача: вывести строку после замены символов и помочь поэту создать совершенное хокку на английском языке.

### Формат ввода

Входные данные содержат строку `s (9 ≤ |s| ≤ 1000000)`.

### Формат вывода

Выведите строку после замены символов. Результирующая строка должна содержать только строчные и заглавные буквы
английского алфавита, при этом количество измененных символов должен быть минимально возможным.
Если подходящих под условие задачи строк несколько, то выведите любую из них.

#### Пример 1

**Ввод**

```
yandexcup
```

**Вывод**

```
YandexCup
```

#### Пример 2

**Ввод**

```
cupyandex
```

**Вывод**

```
YandexCup
```

#### Пример 3

**Ввод**

```
YandexYetAnotherCup
```

**Вывод**

```
YandexYetAnotherCup
```

#### Пример 4

**Ввод**

```
YanCupdex
```

**Вывод**

```
YandexCup
```

#### Пример 5

**Ввод**

```
salkdfjhdskfgpsajdhfgk
```

**Вывод**

```
YandexjhdskCupsajdhfgk
```

## C. Одиночество

- Ограничение времени: 1 секунды
- Ограничение памяти: 64 Mb
- Ввод: стандартный ввод или input.txt
- Вывод: стандартный вывод или output.txt

Жизнь в большом городе полна суеты и забот. Мы постоянно куда-то спешим, не замечая, как самые важные вещи проходят мимо
нас. В режиме постоянного цейтнота мы забываем остановиться на секунду и задать себе простые вопросы:

- Счастлив ли я?
- Есть ли смысл в том, что я делаю?
- Кто я есть на самом деле?

Именно этими вопросами и задался ваш друг, контемпорари-художник - экспрессионист Григорий. В поисках ответов он решил
проверить одну из своих гипотез и устроить невероятный перформанс. Художник развесил в разных местах города `K` маячков.
Каждый из маячков в режиме онлайн показывает расстояние до Григория, при этом само местонахождение Григория остаётся
неизвестным.

У Григория завтра день рождения, и, чтобы поддержать своего друга в период экзистенциального кризиса, вы решили вручить
ему небольшой, но очень ценный подарок. Зная отношение Григория к дням рождения и его привычку отключать телефон за
неделю до и на неделю после знаменательной даты, вам ничего не остаётся, кроме как научиться определять местонахождение
друга по данным с маячков.

Каждый маячок имеет три координаты — <code>X<sub>i</sub>, Y<sub>i</sub> и Z<sub>i</sub></code>. Они соответствуют
некоторой системе в Евклидовом пространстве, которую Григорий построил сквозь весь город. Расстояние от каждого маячка
до Григория вычисляется напрямую, в том числе сквозь землю, когда ваш друг едет на метро.

### Формат ввода

В первой строке число `3 ≤ K ≤ 1000` — количество маячков, которые Григорий разместил в своих любимых местах. Известно,
что Григорий не размещал более одного маячка в одном месте.

В следующих K строках находятся четвёрки рациональных чисел <code>X<sub>i</sub>, Y<sub>i</sub>, Z<sub>i</sub>, D<sub>
i</sub></code> — координаты i-го маячка и расстояние до него до Григория по прямой. Абсолютные значения координат не
превосходят 10.000

### Формат вывода

В единственной строке выведите три рациональных числа <code>X<sub>G</sub>, Y<sub>G</sub>, Z<sub>G</sub></code> —
определённое вами местоположение Григория.

#### Пример 1

**Ввод**

```
3
-5.0 -1.0 9.0 20.4694894905
4.0 -1.0 9.0 16.3095064303
-7.0 6.0 7.0 19.9499373433
```

**Вывод**

```
8.0 4.0 -6.0
```

### Примечания

Зная любовь Григория к Шрёдингеру, может случиться так, что однозначно восстановить координату местонахождения Григория
не получится. В таком случае достаточно вывести лишь одну из точек, в которой Григорий может находиться.

Так как вам предстоит разрешить проблему суперпозиции Григория, вы хотите определить его возможное местоположение как
можно точнее. Точность измеряется с использованием значений десятичных логарифмов разниц фактического и получившегося
расстояния от маячков до Григория. То есть чем точнее удастся определить местоположение Григория, тем больше баллов за
тест Вы получите.

## D. Кому надо платить?

Яндекс Маркет умеет доставлять свои заказы до покупателей через специальные точки, называемыми ПВЗ - пункты выдачи
заказов. Это такие места, где хранятся посылки от многих покупателей. Покупатель приходит в этот ПВЗ когда ему удобно и
забирает заказ.

Недавно Яндекс заколлабился с альянсом современных художников PDF.mafia для креативного оформления ПВЗ. Новый брендинг
переосмысляет концепцию доставки вещей и делает надстройку над айдентикой Яндекс Маркета. Теперь каждый ПВЗ можно
превратить в произведение искусства. Для этого владельцу ПВЗ нужно сделать ремонт помещения согласно брендбуку - это
документ, в котором содержаться обязательные требования к элементам оформления. После того, как ремонт закончен, Яндекс
Маркет возмещает часть расходов на ремонт.

Также существует процесс переоформления: ПВЗ по бумагам переходит от одного владельца к другому. В физическом мире этот
ПВЗ никак не меняется, просто у него меняется владелец.

Для программистов Яндекса брендирование или переоформление ПВЗ – это создание совершенно нового ПВЗ. Такому ПВЗ
присваивается новый идентификатор. При этом в случае переоформления у этого нового ПВЗ есть ссылка на предыдущий
ПВЗ (`pickup_point.prev_id`). Если такой ПВЗ создается после брендирования или переоформления из другого брендированного
ПВЗ, то у него обновляется дата брендирования (`pickup_point.branded_since`) на текущую. К сожалению, данные о
переоформлении не защищены от ошибок ручного ввода и бывали ситуации, когда новый ПВЗ ссылался сам на себя или цепочка
переоформлений замыкалась обратно. Такие случаи следует учитывать и обрабатывать по общим правилам

Уже почти все готово к официальному релизу новости о том, что Яндекс Маркет создает из своих ПВЗ произведения искусства.
Первые владельцы заканчивают ремонт, но еще не написан SQL-запрос, который определяет, кому положены выплаты. Ваша
задача - написать такой запрос.

Схема базы данных описывается скриптом:

```postgresql
-- таблица с пунктами выдачи заказов (ПВЗ)
create table pickup_point
(
    id            bigint primary key, -- id ПВЗ
    branded_since date,               -- дата брендирования - не null для брендированных ПВЗ и null в остальных случаях
    prev_id       bigint unique       -- идентификатор предыдущего ПВЗ (если было переоформление одного ПВЗ на другое)
);

-- таблица содержит данные, что конкретному ПВЗ было начислено конкретное количество рублей 
-- за брендированность. Брендированность = ПВЗ сделал ремонт и мы ему платим деньги
create table brand_data
(
    pickup_point_id bigint primary key references pickup_point (id), -- id ПВЗ
    amount_rub      bigint not null                                  -- сумма, которую заплатили данному ПВЗ, всегда > 0
);
```

Код биллинга, исполняющий запрос на каждый день с момента запуска передает в запрос переменную `:targetDate` - текущая
дата, на которую требуется найти ПВЗ, которые брендированы в этот день и которым полагаются выплаты.

Выплата данному ПВЗ полагается, если выполняются все нижеперечисленные условия:

- этот ПВЗ стал брендированным в дату `:targetDate`;
- для этого ПВЗ (и всех его предыдущих, в случае переоформления) в базе нету данных о выполненных выплатах;

Пример SQL-запроса:

```postgresql
select id
from pickup_point
where branded_since = :targetDate
```

### Формат ввода

В качестве ввода ожидается SQL-запрос, который возвращает одну числовую колонку `id`. Колонка должна содержать
идентификаторы ПВЗ, которым положена выплата на текущую дату.

Текущая дата передается в запрос в виде переменной bind, которую в запросе следует заменить алиасом `:targetDate` (тип
передаваемой переменной - date).

Дополнительные замечания:

- ; в конце запроса не обязательна и не влияет на решение;
- для исполнения запроса используется PostgreSQL версии 15.4

### Примечания

Примеры

#### 1

Наполнение базы данных

```postgresql
insert into pickup_point
    (id, branded_since, prev_id)
values (1000001, date '2020-02-01', null);
```

Тест - рассчитать выплаты на `2020-02-02`

Ожидаемый результат - пустой ответ запроса.

#### 2

Наполнение базы данных

```postgresql
insert into pickup_point
    (id, branded_since, prev_id)
values (1000001, date '2020-02-01', null);
```

Тест - рассчитать выплаты на `2020-02-01`

Ожидаемый результат - `1000001`

#### 3

Наполнение базы данных

```postgresql
insert into pickup_point
    (id, branded_since, prev_id)
values (1, date '2020-02-01', null),
       (2, date '2020-03-01', 1),
       (3, date '2020-04-01', 2);
```

Тест - рассчитать выплаты на `2020-04-01`

Ожидаемый результат - `3`

## E. Биржа минералов

- Ограничение времени: 0.5 секунды
- Ограничение памяти: 64 Mb
- Ввод: стандартный ввод или input.txt
- Вывод: стандартный вывод или output.txt

Некоторые художники используют для создания картин краски на основе минералов: малахита, лазурита и гематита. Для
превращения минералов в краску необходим специальный редкий растворитель.

Группа меценатов заметила, что из-за сложности добычи и неразвитости рынка растворитель сложно покупать и продавать. Они
решили облегчить жизнь художникам и открыть биржу для покупки и продажи растворителя.

Вам предложили поучаствовать в проекте и создать систему, которая будет обрабатывать заявки на покупку и продажу
растворителя:

- Художники публикуют заявки на покупку или продажу растворителя, указывая желаемую цену и количество растворителя;
- Заявки сортируются по цене и объему;
- При появлении новой заявки на покупку или продажу растворителя система сравнивает её с текущими заявками и определяет
  возможность проведения операции
- Если условия новой и существующих заявок совпадают (например, заявка на покупку соответствует заявке на продажу с той
  же или более низкой ценой), происходит сделка;
- В результате сделки объемы заявок уменьшаются на объем сделки, а остатки заявок сохраняются в системе до появления
  следующих заявок.

От новых пользовательских заявок обновляются все текущие заявки - по ходу их выполнения могут появляться данные о
сделках между заявками при достижении совпадения условий. Таким образом, система автоматически подбирает совпадающие
предложения, проводит сделки и обновляет список заявок.

В рамках системы обработки заявок участникам биржи будут доступны следующие возможности:

Первой строкой задается количество операций `n`, которые нужно выполнить. Далее следуют `n` строк, в каждой из которых:

1. Добавить заявку на покупку или продажу растворителя `ADD`.

Участникам будет необходимо указать:

- Тип заявки: покупка `BUY` или продажа `SELL`;
- Цену `price` (число с плавающей точкой);
- Количество растворителя `volume` (целое число).

При добавлении заявки система присвоит ей уникальный идентификатор, который будет представлен в ответе.

Будьте готовы к тому, что сразу после добавления заявки могут произойти одна или несколько операций купли-продажи,
исходя из условий других заявок. Идентификатор должен быть возрастающей последовательностью, начинающейся с 1.

Если поступили заявки с одинаковой ценой, сделка должна производиться с заявкой, которая была добавлена в систему
раньше.

- Пример запроса: `ADD BUY 100.00 5`
- Пример ответа: `1`

2. Просмотреть список актуальных заявок на бирже `GET`. Не требуются дополнительные параметры. У участников будет полный
   список активных заявок на покупку и продажу растворителя, включая идентификатор, тип заявки, цену и количество.
   Обратите внимание, что заявки, которые были полностью выполнены и закрыты, не будут отображаться в этом списке.
   Список актуальных заявок должен выводиться в отсортированном порядке - от большей цены к меньшей.

Если поступили заявки с одинаковой ценой, заявки для покупки должны выводиться в порядке их добавления, а для продажи —
в обратном порядке.

- Пример запроса: `GET`
- Пример ответа:

```
5 SELL 17.00 3
4 SELL 13.00 3
6 SELL 11.00 2
2 SELL 11.00 1
1 BUY 10.00 1
3 BUY 10.00 2
8 BUY 9.00 3
7 BUY 6.00 3
```

3. Отозвать свою заявку `DELETE`. Участникам нужно будет указать идентификатор заявки, которую они хотят отозвать. В
   ответ на запрос система сообщит о результате: `DELETED` — заявка успешно отозвана, или `NOT FOUND` — или заявка с
   указанным идентификатором не существует либо уже выполнена.

- Пример запроса: `DELETE 1`
- Пример ответа: `DELETED`

4. Ознакомиться с информацией о выполненных сделках на бирже `SHOW_OPERATIONS`. Участникам нужно указать количество
   последних операций `amount` (целое число), информацию о которых они хотят получить. В ответе будет предоставлен
   список совершенных сделок с указанием ID заявки на покупку `buyId`, ID заявки на продажу `sellId`, цены `price` и
   количества `volume` растворителя, купленного или проданного в ходе сделки. Выполненные сделки должны выводиться в
   порядке их выполнения.

- Пример запроса: `SHOW_OPERATIONS 2`
- Пример ответа: `1 2 100.00 5`

### Пример

#### Ввод

```
6
ADD BUY 1000.00 5
ADD SELL 1100.00 3
GET
ADD SELL 1000.00 5
GET
SHOW_OPERATIONS 2
```

#### Вывод

```
1
2
2 SELL 1100.00 3
1 BUY 1000.00 5
3
2 SELL 1100.00 3
1 3 1000.00 5
```

### Примечания

При решении данной задачи все операции, связанные с выводом цены, должны быть сопровождены выводом значения с двумя
знаками после запятой.

В случае, если существует несколько подходящих заявок для сделки, выбор происходит между заявками с наименьшей разницей
между ценами покупки и продажи.

При условии, что цена покупки больше цены продажи, сделка будет выполнена по цене, которая была зарегистрирована в
системе раньше.
